<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ–—åŠåŒ æœŸæœ«å†²åˆº Â· å­¦æƒ…çœ‹æ¿ (å®Œæ•´280äººç‰ˆ)</title>
    <!-- å¼•å…¥ Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- å¼•å…¥ React å’Œ ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- å¼•å…¥ Babel ç”¨äºè§£æ JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif; }
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
        .tab-btn { transition: all 0.2s; }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        // --- å›¾æ ‡ç»„ä»¶ ---
        const IconWrapper = ({ children, className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                {children}
            </svg>
        );
        const Search = ({ size = 20, className }) => <IconWrapper className={`w-${size/4} h-${size/4} ${className}`}><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></IconWrapper>;
        const User = ({ size = 24, className }) => <IconWrapper className={`w-6 h-6 ${className}`}><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></IconWrapper>;
        const BookOpen = ({ size = 24, className }) => <IconWrapper className={`w-6 h-6 ${className}`}><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></IconWrapper>;
        const Calculator = ({ size = 24, className }) => <IconWrapper className={`w-6 h-6 ${className}`}><rect width="16" height="20" x="4" y="2" rx="2"/><line x1="8" x2="16" y1="6" y2="6"/><line x1="16" x2="16" y1="14" y2="18"/><path d="M16 10h.01"/><path d="M12 10h.01"/><path d="M8 10h.01"/><path d="M12 14h.01"/><path d="M8 14h.01"/><path d="M12 18h.01"/><path d="M8 18h.01"/></IconWrapper>;
        const Languages = ({ size = 24, className }) => <IconWrapper className={`w-6 h-6 ${className}`}><circle cx="12" cy="12" r="10"/><path d="M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20"/><path d="M2 12h20"/></IconWrapper>;
        const BarChart3 = ({ size = 24, className }) => <IconWrapper className={`w-6 h-6 ${className}`}><path d="M3 3v18h18"/><path d="M18 17V9"/><path d="M13 17V5"/><path d="M8 17v-3"/></IconWrapper>;
        const ChevronDown = ({ size = 16, className }) => <IconWrapper className={`w-4 h-4 ${className}`}><path d="m6 9 6 6 6-6"/></IconWrapper>;
        const ChevronUp = ({ size = 16, className }) => <IconWrapper className={`w-4 h-4 ${className}`}><path d="m18 15-6-6-6 6"/></IconWrapper>;
        const X = ({ size = 20, className }) => <IconWrapper className={`w-5 h-5 ${className}`}><path d="M18 6 6 18"/><path d="m6 6 12 12"/></IconWrapper>;
        const Filter = ({ size = 20, className }) => <IconWrapper className={`w-5 h-5 ${className}`}><polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"/></IconWrapper>;

        // ----------------------------------------------------------------------
        // 1. æ•°æ®æº A: æœ€æ–°å¤šè¯¾ç»Ÿè®¡æ•°æ® (Sheet2.csv) - å…¨é‡æ•°æ®
        // ----------------------------------------------------------------------
        const ATTENDANCE_CSV = `ç”¨æˆ·æ˜µç§°,è´¦æˆ·ç»‘å®šæ‰‹æœºå·,[ç¬¬ä¸€å‘¨æ•°å­¦]-[ä¹˜é™¤è¿ç®—ä¸å…¸å‹åº”ç”¨é¢˜]å­¦ä¹ æ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰,[ç¬¬ä¸€å‘¨è¯­æ–‡]-[å­—è¯å¥ç³»ç»Ÿæ‹”é«˜è®­ç»ƒ]å­¦ä¹ æ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰,[ç¬¬ä¸€å‘¨è‹±è¯­]-[3å¤§ç‹ç‰Œè‹±è¯­å¥å‹ç²¾è®²]å­¦ä¹ æ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰,[ç¬¬äºŒå‘¨æ•°å­¦]-[æ–°æ¦‚å¿µä¸æ˜“é”™ç‚¹æ”»å…‹:åˆ†æ•°ä¸é‡é‡]å­¦ä¹ æ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰,[ç¬¬äºŒå‘¨è¯­æ–‡]-[é˜…è¯»é«˜åˆ†ç§˜è¯€ï¼šç²¾è¯»+ç­”é¢˜æ¨¡æ¿]å­¦ä¹ æ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰,[ç¬¬äºŒå‘¨è‹±è¯­]-[å¬åŠ›&å¯¹è¯ï¼šâ€œç§’ååº”â€è®­ç»ƒ]å­¦ä¹ æ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰,[ç¬¬ä¸‰å‘¨æ•°å­¦]-[å›¾å½¢ç‰¹å¾ä¸è§£é¢˜æ€ç»´æ‹‰åˆ†ç‚¹]å­¦ä¹ æ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰,[ç¬¬ä¸‰å‘¨è¯­æ–‡]-[ä¸‰æ‹›æ­å»ºä½œæ–‡é«˜åˆ†æ¡†æ¶]å­¦ä¹ æ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰,[ç¬¬ä¸‰å‘¨è‹±è¯­]-[é˜…è¯»&é—®ç­”ï¼šè‹±è¯­â€œæŠ“åˆ†â€æŠ€å·§]å­¦ä¹ æ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰,[ç¬¬å››å‘¨æ•°å­¦]-[(æ•°å­¦)é«˜é¢‘æ˜“é”™ç‚¹ç²¾è®²]å­¦ä¹ æ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰
ç•¥ç•¥ç•¥,13590396465,0,36.87,11.03,47.87,52.43,42.83,10.55,0,0,0
æ—¶é—´çš„æœ‹å‹,13540629993,0,0,0,0,0,0,0,0,0,0
à¦á­„Queenà½¼ê¦¿à¿,18335718679,48.68,47.88,0,55.08,55.5,0,0,0,40.12,0
ä¹Œæ—¥åŠ›æ ¼,15947608337,41.08,60.77,34.68,0,28.27,0,0,0.22,0,0
é å•Š,18832932852,0,0,0,0,0,0,0,0,0,0
è,18858677806,15.5,0,51.3,35.88,59.03,50.18,49.53,58.4,40.43,0
é’é’å°ç¦¾è‹—,18877699123,52.32,39.03,58.62,28.3,0,0,0,0,0,0
é“¶å„¿,13540212601,45,59.43,0,0,67.8,0,45,0.33,0,0
ç†Šå²€æ²¡,17686998272,0,0,0,0,0,0,0,0,0,0
æœˆå§‘å¨˜,13388909110,13.07,37.97,46.52,0,15.05,0,0,0,0,0
ç”Ÿå¦‚å¤èŠ±,13668559547,53.9,0,0,0,0,0,3.47,0,0,0
å°é»„åš,13922789319,52.37,60.03,19.98,9.38,0.73,2.2,0,43.97,59.9,50.32
èŒ‰è‰,16637352581,51.63,22.92,15.22,0,65.63,0,49.13,12.3,0,36.18
é™å¿ƒ,13411699409,39.42,22.75,0,0,0,0,0,0,0,0
è¯—è¯­,18774971885,52.28,61.98,60.83,58.6,0,55,0,0,0,0
ä¹ä¹å‘µå‘µ,18500935981,0,0,0,0,0,0,0,0,0,0
é¥­ç²’,18150078391,0,0,0,0,0,0,0,0,0,0
D,18184741132,0,0,46.05,0,0,0.18,0,0,13.88,0.37
èˆ’èŠ³,18915075650,32.93,0,0,0,0,1.78,0,0,0,0
eiwa,,41.17,0.17,16.08,50.3,0,0,0,0,0,0
æ–°å¹¸ç¦ã€‚ã€‚,18222823795,52.45,60.57,65.52,62.38,93.85,57.38,50.88,0,0,0
é™çœ‹æ—¥è½çƒŸéœ,18834339933,64.12,39.55,0,58.13,0,52.95,39.32,59.07,0,0
@æ—,18578275876,23.32,0,0,0,0,0,44.65,0,33.35,37.67
â„³É¬êª–êª€á§,19298851922,50.05,60.47,59.6,59.42,0,0,0,41.15,17.58,1.85
å°å…”å­,13599778031,44.55,0,0,0,0,0,0,0.18,0,0
xiaoli,18361241835,52.53,57.63,63.13,59.18,68.4,52.47,47.93,58.3,56.88,42.7
æ¥ æ¥ ,15165001631,44.5,54.4,55.08,29.17,37.23,12.52,0.4,1.22,55.42,48.15
ä¸½ä¸½,13862564887,50.45,58.3,60.35,60.7,63.23,55.8,45,57.93,54.32,49.97
real life,13568880112,0,0,0,0,0,0,0,0,0,0
å®å®,15093600867,53.4,52.03,68.97,61.32,58.43,51.62,59.23,58.17,60.37,0
Aå°èƒ–å®å¦ˆå’ª,15159825870,30.7,52.42,48.88,39.65,52.32,57.78,50.17,54,26.93,28.1
seven,18523321277,50.68,57,59.02,35.33,58.5,0,52.17,52.62,2.83,47.73
Dan,18910892070,47.82,31.88,62.88,58.75,68.28,54.38,37.8,0,0,0
æ‹¾å…‰ğŸƒ,13864085620,53.85,15.28,57.98,62.08,68.93,53.5,0,0,0,0
ä¸€å¸†é£é¡º,15967536682,0.17,35.82,65.52,40.77,25.43,27.13,16.82,39.4,13.3,31.18
Aç¡•è¾¾é’¢æï¼ˆè„šæ‰‹æ¶ï¼‰15003338007,15003337100,36.48,39.03,6.8,4.12,1.33,0,0.33,0,0,0
ç†™ğŸ‘¦ğŸ»æ‚¦ğŸ‘§ğŸ»,15660010404,52.82,60.3,58.68,59.15,67.52,57.42,47.6,61.13,56.52,42.72
æœ«å­¦,18728182530,0,0,0,58.23,65.92,0,0,0,0,0
æ—å°èŠ³,18628096897,37.48,57.37,45.77,37.22,38.4,36.93,0.4,0,0,0
ğŸğŸ’‹ ğŸ,15938263770,29.92,0,0,0,0,0,0,0,0,0
å¨Ÿå°å¨ŸğŸ’,18659514681,25.37,0,34.05,7.95,1.67,0,0,0,0,0
ğŸ…ç•ªèŒ„å°å¤©ä½¿ğŸ…,18326022523,0,0,0,0,0,0,0,0,0,0
æ–‡ç››ç›¼ç›¼18771384997,18771384997,45.68,105.87,128,30.4,46.2,59.95,47.43,78.07,61.62,42.78
hf,15386096178,1.27,24.88,0,0,0,0,0,0,0.15,0
è€˜å¦ˆ,18353506317,49.88,56,55.78,56.23,67.3,57.47,46.67,60.98,55.8,5.12
åŒæ‡¿,18638525181,21.97,25.57,0,0,0,0.18,20.88,0.7,5.15,0
é¾™é£å‡¤èˆ,13972411566,50.35,0.62,59.28,0,0,48.75,0,0,52.4,0
å¤é›¨,18997673668,0.5,0,0,0,0,0,0,0,0,0
å¾®é›¨è½»å°˜,18203615027,52.63,47.13,62.32,22.67,0,0,0,0,0,0
åŠäº©èŠ±ç”°,18854786526,42.1,0,0,0,0,0,0,0,0,0
Cherry,13928852315,51.33,60.18,61.4,0,65.42,6.15,0,0,0,0
æŸ’æŸ’,13970325266,0.62,0,44.85,44.13,36.98,0.22,0,42.63,0.68,46.25
é’Ÿé›…å¨œğŸ€,18628077185,0.83,1.55,0,0,0.53,0,0,58.35,0,0
æ ‘å„¿ã€‚,18703756735,51.25,62.1,62.47,60.47,0.17,40.92,36.92,56.68,59.03,47.02
é‡‘å–µå–µ,18210408622,52.85,60.15,0,61.8,0,0,0,61.47,0,0
å¾®ç¬‘Alice,15989305209,51.35,55.43,0,26.62,58.28,77.72,0,0,0,0
Beryl  ğŸ€,18380441062,70.5,14.32,47.52,58.18,67.83,0,50.15,61.05,45.93,52.15
ç”œé¥¼,13807321785,74.57,57.92,108.63,61.15,68.55,54.17,51.38,73.93,57.95,47.57
momo,15028217316,0,0,0,0,0,0,0,0,0,0
ğŸŒˆé‚‚é€…Ï†(.ã‰¨.;)ğŸŒˆ,18635732885,0,0,0,0,0,0,0,0,0,0
é«˜å…ˆæ£®,19284962275,0,0,64.73,0,54.22,54.7,51.18,57.62,117.12,0
æ¢“è½©éº»éº»,13916264137,68.1,55.45,19.48,0,0,0,0,0,0,0
å…«ä½°ä¼´æ—æ¸…è½©ä¸¹ä¸¹,,8.82,55.03,0,0,0,0,0,0.35,0,0
é›¨æ‰“èŠ­è•‰,15563500520,32.65,6.13,6.05,0,11.38,0,0,0,0,0
é›…çº¢ï¼ˆå™å°é¦†ï¼‰13310971742,,25.88,5.45,0,0,0,0,0,0,0,0
Catrina,13450890469,52.5,0,1.33,0,0,0,0,0,0,0.18
å”å­¦å»º,13765447468,51.92,1.67,30.35,0,0,0,0,0,0,0
å¡å¤–å¼¦,15872222986,0,14.23,0,28.67,2.72,32.82,0,0,0,0
æ˜¯å¢å°å§å“¦,15916274718,52.67,44.15,66.55,60.85,57.1,0,0,59.68,0.33,50.43
æ¸…æ™¨,15974246178,48.2,60.1,57.23,57.37,31.45,55.07,0,0,0,0
æ¡ƒæä¸è¨€,15911080445,36.85,0,0,0,0,0,0,0,0,0
Misså©§ ğŸ’›,13767061515,51.35,44.07,63.63,61.18,59.52,0,0,0,58.23,40.42
hjyx,,86.53,0,61.57,0,45.02,0,0,0,0,0
ä½ è‹¥å‘é˜³æ˜¥æš–èŠ±å¼€ğŸ¥°ğŸ¥°ğŸ¥°,,0,0,0,0,0,0,0,0,0,0
å›å­ğŸ¾,13810467194,53.53,38.3,62.08,94.05,64.83,51.32,122.72,20.28,33.78,12.87
Yumi,18819020184,51.68,60.02,59.17,56.08,63.77,0,55.23,58.47,55.32,0
à¦ç‹é›¨é‘«,13595164135,50.63,0,0,61,62.88,0,46.28,0,0,0
å’©å’©,13429227321,0,0,0,0,0,0,0,0,0,0
éŸ©ğŸ’è‹å¾…æ”¾,15260105595,52.5,51.37,57.82,37.2,65.8,0,23.38,0,0,0
æå°å…°,15307054193,88.1,1.22,0,0,132.35,20.05,0,0,6.15,0
å¤©è¡Œå¥,18301171799,27.67,84.75,61.5,54.77,61.22,57.67,31.78,0,0,0
é“¶ææ ‘,15081765986,33.28,54.68,0.2,0,21.7,0,0,59.67,60.22,0
æ‚Ÿç©ºç§Ÿè½¦   æ˜Œé¡ºé¸¿ç§Ÿè½¦èƒ¡æ,13235610119,0,0,0,0,0,0,0,0,0,0
é›¨ä¸­æ¼«æ­¥,18855134942,43.53,0,60.55,57.92,63.02,0,0,0,0,44.7
å’æ­Œ,13908704312,52.48,26.22,65.92,60.62,68.72,57.55,33.83,0,0,0
æ™´å¤©çœŸå¥½å‘€,18257805647,46.67,58.47,66.93,61.77,0,57.1,49.88,61.25,59.25,0
æ¿€åˆ°ä½ ç”Ÿæ¬§æ¬§å¥³å£«,18302098414,10.93,60.82,63.82,57.5,69.6,55.25,0,55.35,25.4,0
å¼ ç­±ç‰,15609092892,48.03,0,0,0,0,0,0,0,0,0
é›„,15978229228,0.18,0,0,0,6.45,0,0,0,0,0
ä¸€å¹´çº§ä¸€ç­å´å­è¨€,18886677652,0,0.33,1.05,0.13,47.82,3.03,0,0,0,0
æ¸…é£é¥®éœ²,13430123066,15.15,0.17,0,22.3,51.35,4.6,0,54.68,2.48,0
å¿ƒå‘é˜³ï½æ— æ‰€ç•,18092921706,52.32,49.15,54.02,0,0,0,0,51.13,0,0
å¿«ä¹è‡³ä¸Š,13838102028,0.5,23.02,0.35,0,12.27,0,0,0,17.12,9.18
é¸¿è¿å½“å¤´,13632475490,58.35,29.55,107.12,74.83,64.27,75.38,22.37,59.88,51.07,49.32
æè¯—æ™—,19933277297,35.45,60.2,61.15,56.97,35.98,54.57,0,42.82,0,0
å¢å…‹,15019475685,53.12,54.72,57.1,52.83,63.68,49.53,47.9,60.18,58.12,0
 moon,15100329856,28.53,60.03,57.25,69.03,56.85,53.73,43.38,60.83,46.85,0
çº¢,18591936763,0.7,39,0,0,5.8,0,0,0.2,0,0
Candy,18734429650,51.53,60.08,0,63.18,0,0,0,0,0,0
åŠå¤  å¾®å‡‰,18110388826,49.03,0,0,0,0,43.48,0,0,0,0
AL,15885037624,4.18,61.03,37.72,0.22,54.15,5.83,47.83,0,0,0
æ²™å­,15907155257,6.32,6.13,2.02,29.07,65.87,32.97,0,102.28,37.6,0
ä¸‰è§’æ´²çŒ›æ”»é˜Ÿ,15067559660,51.27,29.88,63.4,51.28,13.1,0.82,0,0,0,0
ä½³æ–‡,13978086833,0,0,0,0,0,0,0,0,0,0
äºŒæœ¨ä¹‹æ—,15854683891,39.5,0,5.55,7.2,66.63,0,42.1,1.17,46.82,0
æ¸…æ™¨,13603079200,52.48,54.85,57.45,9.67,0,0,0,0,0,0
æ©™å­ğŸŠ,18853883172,50.32,56.7,0.5,9.67,0,55.83,49.4,0.55,41.3,0
æŸ³å€©ï½ğŸ’–ğŸ’•,15978978919,59.62,61.93,60.33,56.87,44.28,0,0,0,0,0
å–µå–µ,19072868648,10.85,0.2,22.63,0,0,0,0,0,0,0
å‹¤,15347312700,52.12,63.82,0,59.75,67.62,57.67,36.63,6.63,55.72,0
ccy,18889125760,49.93,48.32,0.17,0,0,0,0,0,0,0
å¦å¦,13599294546,24.45,0,0,0,0,51.02,1.95,62.72,0.18,50.72
æœæœ,13887890605,61.27,49.53,7.13,0,0,0.55,0,0,0,0
ğŸ’ å®¹ğŸŒ´,15072548617,0,0,0,0,0,0,0,0,0,0
å¥ˆå¥ˆ,15815229538,0.57,0,11.22,0,0,0,0,0,0,0
ç¥¥å’Œ(YY),13602390215,51.03,47.75,58.2,59.75,2.85,0.97,10.58,26.85,38.78,0
å°æ»¡,13901219683,0,0,0,0,0,0,0,0,0,0
å½©å½©,13558056768,56.28,0,0,0,43.78,51.33,41,0,0,0
åˆ˜ä¸½,15364186883,48.68,52.55,57.52,60.33,65.25,55.33,5.18,60.15,0,7.25
å¯æ‚¦å„¿,,43.03,40.88,50.38,57.12,60.35,50.82,48.95,52.52,57.53,3.58
ä¿¡ä»°ä¹‹ç«,15211450598,51.98,54.75,55.45,3.25,5.98,0,0,0,0,0
è‹¥è‹¥,15387962430,48.55,0,0.42,59.28,63.78,51.22,45.9,57.53,43.13,0
æ°¸éœ,15008960867,22.93,12.48,0,0,10.17,0,21,0,0,0
å° å¢¨,15515798233,49.08,0,0,56.27,68.43,57.42,52.77,0,0,37.22
çˆ±è°è°@ ,,52.55,38.85,1.52,0.52,0,0,0,0,0.8,1.33
é”´é”´å¦ˆ,13650939986,31.95,0,0,0,0,0,0,0,0,0
æ—¶å…‰èè‹’ğŸ§¨,19946505356,0,0,0,0,0,0,0,0,0,0
Simple,18326960813,14.48,0,14.12,0,0,0,0,0,0,0
å¶ç„¶,15891489924,25.9,62.15,69,107.47,68.43,61.17,68,0,3.03,49.57
è‰æ´,17689490616,51.43,63.22,0,39.27,2.95,0,0,0,0,0
Angel,15168932942,19.9,0.87,0,0,0,0,0,0,0,0
æ¨ç¢§äº‘,13984469906,45.45,38.72,47.63,53.65,0,46.62,0,5.42,0,0
ç”Ÿæ´»æ¯æ—¥å‘é˜³,13063337039,80.15,42.08,61.75,37.12,68.17,59.3,47.25,61.03,47.47,41.68
å°è·¯,18023335372,51.97,0,39.75,23.42,38,0,0,0,0,0
A   Qå®å®è |æ¯å©´å„¿ç«¥å¥åº·è°ƒç†å¸ˆ,15768091198,51.88,55.85,51.95,49.18,57.77,54.57,38.05,59.05,56.78,52.92
æ¢…,18209035600,56.7,83.55,61.77,0,52.97,52.13,25.5,41.45,22.65,30.63
ç®€ä»¥æ—¶å…‰,13322920139,54.62,0,0,0,0,0.57,0,0,0,0
ä¸é›¨,18911562688,46.87,60.5,63.58,0.17,0,0,0,0.38,0,0
ä¸‡,15921791417,51.2,57.07,63.25,59.2,66.95,55.73,48.7,58.65,57.63,47.62
å¾®èƒ–ç•Œ*,13389512921,47.7,0,0,0,0,0,0,0,0,0
momo,13840128132,0,0,0,0,0,0,0,0,0,0
æ¬£~æƒ³äº‹æˆ,15103119992,76.82,123.3,122.82,114.25,26.37,24.22,43.03,0,60.23,26.98
5858588,13757160367,48.78,63.72,36.72,33.28,14.15,48.47,0,0,0,0
é£ä¿¡å­,17379323004,62.73,56.48,26.1,38.13,66.57,57.62,44.48,59.73,57.9,49.67
CXJ,13485185292,0.42,0,63.4,0,68.58,57.75,0,0,0,0
è±å¦ˆ,18974074635,3.55,0,0,0,0,0,0,0,0.67,0
æ— ä¸º,15976481892,20.63,0,0,0,0,0,0,0,0,0
Aå¤§åˆ«å±±å»ºç­‘æ¨¡æ¿  æ¡‘æ˜æ˜,13285649596,0.22,0,29.22,0,0,0,0,0,0,0
A.åŒé™ˆæ™®æ´±ğŸ’å°å…°,13826614574,4.95,4,0.22,9.4,5.72,0.32,14.95,4.55,4.42,0
ç–¯ç‹‚çš„å°çŒª,18751048660,44.8,0,0.52,0,0,0,0,0,0,0
momo,13732237327,0,44.83,60.97,0.17,15.83,18.82,46.17,0,0,0
ğŸŒ¿,13382903242,0,0,0,0,0,0,0,0,0,0
æ¢…èŠ±,13633820561,32.02,53.23,30.33,1.32,0,0,0,0,0,0
Aaäººä¿è½¦é™©ç‹èŠ³à¼˜,18955261110,51.92,120.27,51.75,61.52,68.35,0,46.4,71.28,76,50.92
AçµèŠ,13022346992,42.83,53.9,0,0,0,0,0,0,0.5,0
River,18956096101,50.22,47.1,63.85,61.77,52.47,0,50.32,59.98,59.05,22.08
Tonyæ°,,35.33,42.8,80.93,22.37,15.35,56.05,0,48.9,0,0
ä¸‡é‡Œæ™´ç©º,13811679021,0,0,0,0,0,0,0,0,0,0
å‹¤å‹¤,15610276885,30.03,63.33,52.72,59.75,57.05,0,44.98,20.67,25.67,0
å¤§é™é™,15156933353,49.3,0,0,0,0,0,0,0,0,0
Jennie,18621955455,73.63,37.1,10.38,72.92,76.48,14.15,0.25,53.28,0,0
Truboå·§ç¿˜,13926682396,58.48,66.9,68.58,0,77.98,58.92,0,0,36.07,0
A å¤æœˆ,18315379089,126.48,69.27,66.83,45.18,0,21.67,46.33,23.5,56,50.5
Êšé˜¿çŒ«É,16600262813,0,0,0,0,0,0,0,0,0,0
æ‰è¥¿å“ç›0ç’ç’,18977088333,0,0,0,0,0,0,0,0,0,0
ç‹è“‰,15965097804,47.72,9.97,0,51.82,14.52,37.72,0,51.33,15.78,27.65
åˆå»ç»™ä¹ƒçƒŸ,13655556185,63.92,62.32,60.35,62.03,66.27,56.45,47.58,60.67,75.83,0
é™ç•Œ,13622078007,0.18,0,0,0,0,0,0,0,0,0
æ©™å­,13825963753,28.37,40.48,34.43,52.53,38.97,66.93,0,52.12,62.23,42.02
æè‹—ğŸ’1598***4862,15986434862,55.4,0,0,67.02,4.73,48.5,62.03,59.15,34.9,0
ğŸŒˆä¹”å¦¹å„¿,19350561818,51.8,58.2,0,60.08,0,0,0,0,0,0
æå¼º,13809276245,49.87,56.68,62.1,123.08,69.88,58.6,78.07,49.22,57.37,51.67
å¹³å‡¡,13879652020,25.57,45.32,59.92,36.38,0,6.77,21.7,38.35,56.75,48.23
å®‰å‰å°”å‡€æ°´é»„ï½çç18779579619,18779579619,34.48,4.07,84.42,0,0,52.1,0,24.47,10.87,0
å¤§æœç²’,18764616139,3.72,36.27,21.08,0,73.88,53.27,0,57.07,45.32,45.03
æ¢æ™ºæ ©î€¢,,0,0,0,0,0,0,0,0,0,0
LeticeğŸŒ¸,13636466645,0,5.75,0.72,0,0,0,0,5.78,2.02,0
æ–‘æ–“,13968538380,0,0,0,0.23,1.08,9.42,25.58,0,0,10.55
é›¨æ–‡,13606851243,0,0,0,0,0,0,0,0,0,0
åˆ˜ä¸½è‰,13720436986,48.97,54.68,0,0,0,0,0,0,0,0
å‘é˜³,15173919201,18.4,26.8,7.78,0,19.98,0,0,0.35,39.45,0.82
å°æŸ’æ—ºğŸ¶ã…,18609932020,0,0,0,0,36.3,0,0,0.82,1.5,0
å¼ æ¼”,13529493043,12.93,0,0,0,0,4.28,0,0,0,0
å©‰äº‘,19872909828,38.5,30.07,55.12,53.7,66.85,48.37,41.5,57.75,49.12,0
å®‰åº·æ˜¯ç¦,13349631178,52.4,43.33,41.7,66.6,0,29.48,38.07,0,0.35,0
å²æœˆå‡é¦™,18559648163,16.62,13.05,59.77,56.38,36.87,0,28.78,0,0,0
ç´ç´,15872962839,45.88,66.7,51.83,26.62,68.78,55.03,44.57,61.28,59.1,49.7
ğŸ‘‘X.xiangğŸ’«,13988829011,0.35,0,0,0,0,0,0,0,0,0
ç¦å›ğŸ’,18011468692,42.27,0,54.68,59.77,67.3,56.87,42.03,58.75,58.48,47.23
â€˜@  è¡—è§’æ—³ç¥ç¦,16673625018,49.57,44.67,54.67,80.9,66.42,54.07,38.57,61.6,33.73,44.45
å¿«ä¹ä¸€ç”Ÿ,13602109081,2.13,5.78,0,54.63,65.43,3.82,49.57,26.03,2.65,0
ä½³ä½³,15810316558,0,0,0,0,0,0,0,0,0,0
å®‰æ ¼çš®è‚¤èº«æç®¡ç†,18670079765,30.27,0,34.7,30.43,0,43.33,27.5,0,49.72,0
å¨Ÿå­,15994726421,0,0,0,0,0,0,0,0,0,0
å†¬å¤©é‚£æŠŠç«,18101348350,51.27,59.48,62.02,60.07,64.92,0,0,0,0,0
ã€‚ï¼,17697327021,46.17,58.03,65.88,66.65,68.6,57.88,50.8,60.8,55.78,50.27
éœ²å­,18727160721,52.07,57.83,25.58,61.63,66.92,52.5,50.02,54.77,57.9,52.15
Fang,13999863634,0,0,37.02,61.62,72.48,56.87,50.07,57.68,59,63.42
ç½—é“¶,13469278497,0,37.48,0,0,0,38.87,0,0,0,0
ç¨»ç”°,15070980472,52.78,52.22,59.53,61.1,68.75,55.12,48.85,62,59.42,49.5
éƒ‘æ™“èŒµ,13435289624,8.77,0.5,75.47,0,6.27,0.67,43.6,0.17,0,50.32
å­œè¯­,13575569205,0,0,0,0,0,0,0,0,35.5,0
é»„æ–‡è‹±,17875437332,37.1,57.43,59.17,62.33,68.78,36.97,48.27,61.88,57.63,52.83
å°å¨…Â·,15990338732,0,0,0,0,0,0,2.35,0,0,0
å–œä¸Šæ¢…ç¨,13608937309,0,0,0,0,0,0,0,0,0,0
å¼ å°æ‡’,18184025686,0.18,0,0,0,0,0,0,0,0,0
çˆ±ä½ å“Ÿ,18705002938,0,0,0,0,0,0,0,4.82,13.33,0
ğŸ’,,37.4,0,0,0,0,0.33,0,44.6,0,0
æ–‡,13958870313,0.17,0,0,0,0.5,0,0,0,0,0
A é™å¾…ğŸ’èŠ±å¼€,15333359839,52.43,59.67,134.52,59.22,66.9,51.22,49.98,60.07,57.85,52.52
å¿«å¤„å¿«èµ”å¢è‰³,18975843280,47.12,55.82,0.17,0,63.42,0,0,27.9,0,0
å°V,15982827711,0,0,0,0,0,0,0,0,0,0
Sherry,13962996071,12.15,0,0,0,0,0,0,0,0,0
å°è¯º,13687963598,0.5,58.2,35.4,0,0,0,0,0,0,0
æµªè¿¹å¤©æ¶¯,13625949748,72.62,56.8,62.27,58.43,47.78,57.12,48.87,69.95,41.13,50.05
æš–å…‰æµ…ç¬‘,13653370861,0,0,0,0,0,0,0,0,0,0
life is like?,18191570765,0,0,0,1.18,26.25,0,0,0,0,0
ğŸŒ¾,18950427273,13.02,37.13,0,0,0,0,0,0,0.2,0
æ¬£,17732293629,51.33,60.48,66.07,59.02,74.48,0,0,0,0,0
Aî„ å†‰å†‰å¦ˆå¦ˆğŸ€,18790793260,39.22,34.98,53.27,55.65,63.62,57.93,49.22,59.53,0,47.93
å°é¸­å…”,13560051272,1.88,0,0,0,0,0,0,0,0,0
hi æ¨ç›¼ç›¼,13600542708,67.27,57.15,59.22,52.95,64.92,44.88,25.73,57.9,59.4,0
æš–æš–çš„,15837366824,52.68,50.38,0,0,0,0,0,0,0,0
soloï¼‡,15114588868,0,0,0,0,0,0,0,0,0,0
ä¸è´ŸéŸ¶åğŸ‡¨ğŸ‡³å¾å°ç‡•,13599159188,0,0,0,0,0,0,0,0,0,0
ç™½æ²³å²¸è¾¹,18337658526,52.3,59.45,59.22,54.47,67.8,55.67,49.97,57.73,59,0
ğŸŒˆğŸŒˆsky ğŸŒ» YaliğŸ­ğŸ­,13690556613,100.37,119.05,117.62,121.88,136.43,55.3,43.85,0,56.45,44.7
summeræ£®,13711745853,51.45,48.35,57.97,59.95,65.37,48.48,49.78,58,104.18,0
èˆå¾—,13540776772,53.08,64.5,59.82,55,0,52.85,48.73,0,0,39.48
momo,,0,37.35,31.78,5.2,30.77,0,24.92,0,0,0
AîŒ”æ—èŠ¯è´¢ç¨îŒ”18856252220,18856252220,49.6,59.38,0,0,0,0,0,0,0,0
èœ‚èœœ,18180893323,99.87,64.8,128.33,61.83,68.42,88.63,0,0,0,0
SusieğŸ°,13488777132,0,0,0,0,0,0,0,0,0,0
å‡¤å¦¹å„¿,18283582649,27.55,52.27,0,0,0,0,0,0,0,0
å¾·æ±ŸçœŸè´èœ‚ç³–æç§æ¤ä¸“ä¸šåˆä½œç¤¾,18984552342,57.75,52.08,78.48,58.87,101.25,94.62,30.18,45.65,43.33,39.93
å°å¨Ÿ,13970746546,48.82,33.3,62.63,48.08,57.73,41.58,47.68,65.75,41.33,50.83
å‚²é›ªå¯’æ¢…,13389884978,13.92,0,1.1,0,5.58,0,0,9.47,0,0
å¤©æ¶¯æµ·è§’,13952937887,29.62,58.88,50.7,59.32,0,0,0,0,0,0
é­é­ğŸ¦ğŸ°,13938946431,49.75,1.03,19.73,52.28,62.92,52.35,43.93,58.48,0,0
ä»å¤´å¼€å§‹,18362547919,4.83,1.67,25.5,16.63,73.53,0,0,0.33,5.93,0
è®¸å¤,17755131437,52.67,61.88,66.78,61.43,53.83,54.63,32.7,70.13,42.25,0.55
è™½å©‰~,13694867407,45.77,50.08,56.03,61.17,15.1,0,0,0,34.48,0
Sammi,13537787762,1.15,0,0,0,0,0,0,0,0,0
L.T,15828652061,53,55.98,75.45,54.57,71.78,58.67,44.73,60.3,70.3,34.7
å°æ¬¢å–œ,15963107787,43.28,57.25,60.62,34.43,37.55,38.47,0,50.48,53.13,1.55
cynthia2015,15997319470,0,0,0,0,0,0,0,0,0,0
Kili,13580550141,49.13,60.97,50.3,61.2,55.08,0,33.47,0,0,0
é£ç­,15259279846,5,55.23,48.97,3.83,25,1,0,0,0,0
æ¥ æ¥ ğŸ’‹,15562376059,0,0,0,0,0,0,0,0,0,0
ä½©,13750244511,0,0,0,0,0,50.25,41.2,9.55,39.7,0
æ´›ç¥èŠ±,15935980720,52.1,59.92,66.2,60.42,68.88,54.17,49.15,7.2,57.93,19.15
å½­ç¿©,15179969160,50.73,0,59.27,61.47,57.25,0,37.38,55.58,1.98,41.35
change,15620512339,8.15,60.25,61.52,63.5,69.52,0.38,0,72.33,0,0
ä»™äººæŒ,13784464176,48.57,58.62,52.72,63.95,58.92,52.45,50.78,63.43,56.65,51.38
13754063202æ·¡å¦‚èŠ,,35.58,64.13,67.25,61.85,61.42,56.75,50.33,61.6,27.85,52.33
ğŸ’ç´ ç´ ğŸ,18964329725,48.83,52.53,47.18,41.85,64.7,58,25.52,0,0,2.68
è¥¿è¥¿,15260329550,46.92,38.28,23.68,56.77,60.82,0,0,6.85,0,0
Sunnyï½,18381665777,0,0,0,0,0,0,0,0,0,0
æå§,13977010113,52.42,59.73,63.45,62.2,67.73,57.45,49.62,62.78,61.17,51.87
å“ˆå–½è´æ¯”æ—©æ•™Rita æ¨è€å¸ˆğŸ’•,15007652517,0,26.93,52.85,62.83,38.17,92.98,0,61.42,0,0
ğŸ’„å†°æ·‡æ·‹æ ¼å­ğŸ’„,18632266075,49.77,57.15,0,101.63,40.3,0,0,37.65,0,0
ä¸€å®‰Recluse,18984238288,0,0,0,0,0,0,3.33,0,0,0
lmxhzc,13520026985,51.67,69.47,57.45,0,58.93,52.33,50.8,0,0,0
æ  åˆ«ç®¡,15617694687,51.25,0,57.22,33.65,0,0,0.48,0,0,0
åšè‡ªå·±çš„è‹±é›„ ğŸ‘‘,15369916188,0,58.67,4.05,0,49.38,0,0,0,0,0
å†°æ´,13642137022,56.87,59.68,59.45,57.7,0,0,0,34.32,0,0
åº·  é™,18195588825,0,0,0,0,0,0,0,0,0,0
AğŸ¥æ¡‚æ—é›…å›¾æ‘„å½±,18078359002,0,0,0,11.65,19.02,0,0,0,0,0
å§œæµ·,,10.5,60.27,66.48,44.78,68.52,54.35,0,60.03,58.68,47.93
Han,,36.77,0,41.1,53.53,0,0,0,0,0,0
loyi,13874614580,0,0,0,0,0,0,0,0,0,0
é™ˆé‡‘èŠ±,13701770433,49.97,69.03,44.72,57.2,89.9,0,40.88,80.17,0,50.4
Ivy,13922238770,69.03,96.15,0,0,21.87,0,0,48.18,0,0
é£é›¨å¤©æ¶¯ä¸­åŒ»é’ˆç¸,18781079661,50.88,18.92,51.55,12.58,7.62,56.22,47.15,55.95,25.23,50.8
é™ˆçº¢,13965853028,47.77,55.23,0,0,0,0,0,0,0,0
ç¹,13546206232,34.82,66.12,56.08,14.5,0,0,0,0,0,0
æ®·å§—,18391462960,53.25,0,0,0,0,0,0,0,0,0
ç”œä»¥å¾…äºº,13935637070,57.13,52.88,53.87,60.15,116.32,51.2,51.33,0.17,48.5,0
é€†æ—…å°˜,18826291827,19.83,62.38,35.85,0.22,0,0,37.57,0,0,0
é‚¹é¦¨å®,13874318788,51.3,0,0,0,0,0,0,0,0,0`;

        // ----------------------------------------------------------------------
        // 2. æ•°æ®æº B: å†å²æ¡£æ¡ˆæ•°æ® (ä½œä¸ºå­—å…¸ï¼Œä¸ç›´æ¥å‚ä¸è¡Œç”Ÿæˆ)
        // ----------------------------------------------------------------------
        const STUDENT_INFO_CSV = `å­¦å·,å¾®ä¿¡æ˜µç§°,å­¦å‘˜å§“å,è”ç³»ç”µè¯,å…¥å­¦æµ‹è¯•æƒ…å†µ
S1,A.åŒé™ˆæ™®æ´±ğŸ’å°å…°,å‘¨å˜‰å®,13826614574,75
S2,ä¸‡é‡Œæ™´ç©º,æœ«æœ«,13811679021,-
S3,Aî„ å†‰å†‰å¦ˆå¦ˆğŸ€,æè‹¥å†‰,18790793260,80
S4,æˆ‘åˆæ”¹äº†æˆ‘çš„å¾®ä¿¡åğŸ˜„,å˜‰æ·‡,15935980720,95
S5,é‡‘å–µå–µ,äºéœéœ,18210408622,-
S6,é’Ÿé›…å¨œğŸ€,æ©™å­,18628077185,-
S7,äºŒæœ¨ä¹‹æ—,æä¸€å¸†,15854683891,0
S8,ğŸ’ç´ ç´ ğŸ,ä¼˜å®,18964329725,-
S9,ccy,ç”œç”œ,18889125760,0
S10,åˆå»ç»™ä¹ƒçƒŸ,æœ±é›¨è±,13655556185,-
S11,Le vent se lÃ¨ve,è¯—æ™—,19933277297,-
S12,å­œè¯­,å°æŸ æª¬,13575569205,-
S13,æ¬£,åˆ˜å°å—,17732293629,20
S14,ä½ è‹¥å‘é˜³æ˜¥æš–èŠ±å¼€ğŸ¥°ğŸ¥°ğŸ¥°,äº¦å®¸,17375188362,0
S15,é»„æ–‡è‹±,å´‡ç¿,17875437332,170
S16,hi æ¨ç›¼ç›¼,å—ç“œ,13600542708,140
S17,èƒ¡å®¶äºº,è°¢å…®çŸ¥,18126151765,65
S18,èˆå¤œ\`\`îŒ®æº îŒœî€² î€´,é¦¨é¦¨,13840128132,-
S19,å¿«ä¹ä¸€ç”Ÿ,é©¬æŒ¯æ˜Š,13602109081,0
S20,áƒ¦Hope.,-,-,-
S21,å…°å¿ƒæ…§æ™º,ä½³å¦,15307054193,0
S22,è±å¦ˆ,ç‘¾è±,18974074635,70
S23,åšè‡ªå·±çš„è‹±é›„ ğŸ‘‘,å®¸å®¸,15369916188,-
S24,æœ«å­¦,ç³–æœ,18728182530,-
S25,é˜¿é¹‚,è‹¥è‹¥,15387962430,120
S26,soloï¼‡,è¾°è¾°,15114588868,0
S27,change,èƒ¡ä¼Šæ™—,15620512339,0
S28,@æ—,ä½™æƒœ,18578275876,95
S29,å”å­¦å»º,é—µç³æ·‡,13765447468,-
S30,çº¢,è‚–å¸…å¸…,18591936763,140
S31,â€˜å®¸,éƒ‘ç‘¾è¾°,18705002938,-
S32,é¥­ç²’,å­è¶Š,18150078391,-
S33,A é™å¾…ğŸ’èŠ±å¼€,æ¢“ç†™,15333359839,0
S34,æ–°å¹¸ç¦ã€‚ã€‚,ç•…ç•…,18222823795,185
S35,æ‰è¥¿å“ç›-ç’ç’,é™†é›¨æ™¨,18977088333,-
S36,á¨³ Misså©§ê¢† ğŸ’›,ç‹é›¨è¾°,13767061515,105
S37,å½­ç¿©,è¨€è¨€,15179969160,10
S38,Êšé˜¿çŒ«É,æ©™å­,16600262813,-
S39,èœ‚èœœ,å¾è¯—æ·¼,18180893323,-
S40,Aå°èƒ–å®å¦ˆå’ª,èƒ–å¢©,15159825870,-
S41,å¼ å°æ‡’,åˆ˜æµ©æ¥ ,18184025686,-
S42,Jennie,ç«¥æµ©å®¸,18621955455,50
S43,é›¨æ‰“èŠ­è•‰,å®¸å®¸,15563500520,0
S44,å°è·¯,Leo,18023335372,0
S45,é˜¿å»–,å°ä¹–,15885037624,-
S46,é™ˆçº¢,æ—å¦,13965853028,105
S47,ç”Ÿå¦‚å¤èŠ±,é”é”,13668559547,-
S48,ğŸƒèŒ¶çƒ¬ä½™é¦™,æ­¦æ¢¦ç³,19946505356,-
S49,é›¨æ–‡,å°è¶…,13606851243,0
S50,seven,å¤•ç‘¶,18523321277,120
S51,å®‰åº·æ˜¯ç¦,é‚å½¦é“­,13349631178,-
S52,æš–å…‰æµ…ç¬‘,è²è²,13653370861,-
S53,Aaäººä¿è½¦é™©ç‹èŠ³à¼˜,ä½™è‹¥ç†™,18955261110,120
S54,å§œæµ·,ä¿Šåš,13960575059,0
S55,æ´‹ğŸŒ¸,è€”èŒ—,15736736735,125
S56,ã€‚ï¼,æœ±å…®å…®,17697327021,-
S57,à¦ç‹é›¨é‘«,èˆªèˆª,13595164135,40
S58,SusieğŸ°,æºªæºª,13488777132,-
S59,life is like?,å°è¾¾,18191570765,-
S60,ç–¯ç‹‚çš„å°çŒª,å¸æ–‡å¸Œ,18751048660,-
S61,é¾™é£å‡¤èˆ,æ¡æ¡,13972411566,0
S62,é£ç­,é™ˆæ¶¦,15259279846,0
S63,æ¸…æ™¨,æ›¾å­çº¹,13603079200,100
S64,Aå¤§åˆ«å±±å»ºç­‘æ¨¡æ¿æ¡‘æ˜æ˜,å¸…å¸…,13285649596,0
S65,è¥¿è¥¿,é™ˆå®¥åœ»,15260329550,0
S66,åŠå¤ å¾®å‡‰,èŒœèŒœ,18110388826,0
S67,ç®€å•å°±å¥½,è–›æ™ºæº,18853883172,0
S68,ä¿¡ä»°ä¹‹ç« ğŸ‡¨ğŸ‡³,å¤å¤,15211450598,-
S69,é’é’å°ç¦¾è‹—,å°å®‡,18877699123,100
S70,å°æŸ’æ—ºğŸ¶ã…,é›ªå„¿,18609932020,-
S71,åŠäº©èŠ±ç”°,æ‚¦æ‚¦,18854786526,60
S72,æ—å°èŠ³,æ˜“æ¸¸,18628096897,45
S73,åŒæ‡¿,ç‹ä¸€ç¦¾,18638525181,65
S74,æŸ³å€©ï½ğŸ’–ğŸ’•,é¦¨å¦¹,15978978919,-
S75,D,å½¤å½¤,18184741132,0
S76,ä¹ä¹å‘µå‘µ,ç‰›å¥¶,18500935981,0
S77,ğŸ’ å®¹ğŸŒ´,å­æ’,15072548617,-
S78,å‚²é›ªå¯’æ¢…,è¾°å®¸,13389884978,-
S79,è¿è¾‰,é›¨é¦¨,13560051272,0
S80,Angel,å­£å®‡ç¡•,15168932942,105
S81,Sherry,æ—¶å¡¬éˆŠ,13962996071,-
S82,é‚¹æ™–,é‚¹é¦¨å®,13874318788,130
S83,ï¼Œ,å­æ¶µ,13599778031,0
S84,ä¸€æ²™,-,-,-
S85,Candy,å½¤å½¤,18734429650,170
S86,èˆå¾—,å»–å­è¯š,13540776772,0
S87,æ¸…é£å¾æ¥,æ­†æ­†,13716048303,70
S88,ç”œé¥¼,å˜‰è±ª,13807321785,90
S89,å¾®èƒ–ç•Œ*,ä½³ç¦¾,13389512921,90
S90,è™½å©‰~,å¯é¦¨,13694867407,20
S91,äºŒåå››æ¡¥æ˜æœˆå¤œ,æ¶µæµ©,15264251860,-
S92,cynthia2015,ç½—æ™¯éœ–,15997319470,-
S93,á­„Queenà½¼ê¦¿à¿,ä¸€ä¸€,18335718679,135
S94,@æ²«æ²«_ğŸŒˆ,-,-,-
S95,ç¥¥å’Œ(YY),å°é–,13602390215,65
S96,Sunnyï½,-,-,-
S97,Truboå·§ç¿˜,å·§å„¿,13926682396,-
S98,è®¸å¤,è®¸å¤,17755131437,0
S99,å½©å½©,ä½³ä½³,13558056768,35
S100,å–œä¸Šæ¢…ç¨,å‘¨ä¹¦å¼˜,13608937309,-
S101,ç¦å›ğŸ’,åˆ˜è¾°ç¥,18011468692,-
S102,èŒ‰è‰,é™é™,16637352581,120
S103,åº· é™,é»„è‹¥å…ƒ,18195588825,0
S104,å¤šå§¿å¤šè´¢ğŸ¦š,èµ–çš“æ³½,13970746546,105
S105,ä¹Œæ—¥åŠ›æ ¼,æ¬§è‹å’Œæ¯…æ¸ƒå²±,15947608337,95
S106,æ™¨å„¿,å¸ƒä¸,13520023985,-
S107,åˆ˜ä¸½,åŸ,15364186883,110
S108,é£ä¿¡å­,æ¬£æ¡,17379323004,125
S109,Beryl ğŸ€,ä¸²ä¸²,18380441062,-
S110,å¡å¤–å¼¦,èŠŠèŠŠ,15872222986,150
S111,ğŸ€ä¸‡,æ¬æ¬,15921791417,15
S112,æ‹¾å…‰ğŸƒ,é™ˆç°å‡,13864085620,180
S113,å¥ˆå¥ˆ,å­œå­œ,15815229538,-
S114,Han,å¤å¤©,13521268192,-
S115,é¸¿è¿å½“å¤´,é»„å…†é¸¿,13632475490,-
S116,Kili,æ´‹æ´‹,13580550141,5
S117,å¤©è¡Œå¥,æ™¨æ™¨,18301171799,170
S118,æ¨ç¢§äº‘,å§œæ…§ç‘œ,13984469906,70
S119,é“¶å„¿,æ—ç¥è¾°,13540212601,-
S120,æµªè¿¹å¤©æ¶¯,å°å®‡,13625949748,165
S121,å¤§é™é™,ç‹ç‘ç…,15156933353,0
S122,é“¶ææ ‘,å°æº¥,15081765986,45
S123,å¿«ä¹è‡³ä¸Š,è¢èµ«æ³½,13838102028,100
S124,æŸ’æŸ’,å¦å¦,13970325266,-
S125,é€†æ—…å°˜,å°å–œé¹Š,18826291827,-
S126,é›ªè§,éƒ‘æ²»,17686998272,-
S127,å¨Ÿå°å¨ŸğŸ’,ä½•æ¬£æ€¡,18659514681,120
S128,ç•¥ç•¥ç•¥,é›¯é›…,13590396465,60
S129,å‹¤,å“²å“²,15347312700,120
S130,ä»™äººæŒ,å½¬å½¬,13784464176,70
S131,è§£éœ19201589982,å°çç ,13952937887,0
S132,Sammi,ç±³ç³Š,13537787762,0
S133,å‹¤å‹¤,å†‰å†‰,15610276885,100
S134,moon,è‰¾ç±³,15100329856,-
S135,å®‰æ ¼çš®è‚¤èº«æç®¡ç†,ç±³æœµ,18670079765,75
S136,æ¢“è½©éº»éº»,é¾šæ¢“è½©,13916264137,-
S137,é™ˆé‡‘èŠ±,è¢éªå°§,13701770433,160
S138,A å¤æœˆ,äº¦ä¸º,18315379089,0
S139,è¯—è¯­,åª›åª›,18774971885,0
S140,Simple,è¥¿è¥¿,18326960813,0
S141,é­é­ğŸ¦ğŸ°,ç¥å½¤,13938946431,135
S142,Hl,è¾°å®‡,18107207550,-
S143,æ·¡å¦‚èŠ,é™ˆå–†,13754063202,95
S144,æ®·å§—,è®¸æµ·ä¹,-,0
S145,æ¢…èŠ±,æœµæœµ,13633820561,0
S146,Gaby,é»„åš,13922789319,0
S147,xiaoli,æ˜Ÿå®‡,18361241835,110
S148,å¾·æ±ŸçœŸè´èœ‚ç³–æç§æ¤ä¸“ä¸šåˆä½œç¤¾,ç”˜å®‡æ™¨,18984552342,0
S149,æ¥ æ¥ ğŸ’‹,æ¢¦è¡,15562376059,-
S150,äººé—´æ¸…é†’,è‚–æ¥šåš,13322920139,-
S151,å±±æœˆæµ®é…©ã€‚,èµµæ€é½,19072868648,130
S152,â€˜@ è¡—è§’æ—³ç¥ç¦,åº·åº·,16673625018,70
S153,River,ä½•æ´›ä¼Š,18956096101,0
S154,æ˜¯å¢å°å§å“¦,æ€ç‘¾,15916274718,-
S155,ç”Ÿæ´»æ¯æ—¥å‘é˜³,ç¬‘ç¬‘,13063337039,95
S156,åˆ˜ä¸½è‰,æ­¦ä¹æ‡¿,13720436986,0
S157,å¦å¦,ææ´¥é“Œï¼ˆèŒèŒï¼‰,17759514880,-
S158,ä½³ä½³,è¥¿è¥¿,15810316558,-
S159,å° å¢¨,æå¢¨,15515798233,150
S160,äºŒå¹´çº§ä¸€ç­å´å­è¨€,å­è¨€,18886677652,0
S161,å›å­ğŸ¾,åˆ˜æ€æ¶µ,13810467194,45
S162,è,æå›½å®‡,18858677806,-
S163,æ— ä¸º,-,-,0
S164,å¼ ç­±ç‰,æ›¹è·ƒå‡Œ,15609092892,-
S165,é¹…è›‹è›‹è‹¥è‹¥,è‹¥è‹¥,15959647137,0
S166,æ¢…,ç‹å°å®‡,18209035600,130
S167,é”´é”´å¦ˆ,è‚–ç«£æµ ,13650939986,-
S168,5858588,æéœ‡ç¦„,13757160367,60
S169,æå¼º,é›¨å½¤,13809276245,0
S170,Aç¡•è¾¾é’¢æï¼ˆè„šæ‰‹æ¶ï¼‰15003338007,ç¡•ç¡•,15003337100,135
S171,â„³É¬êª–êª€á§,å”æ¢“ç¿,19298851922,0
S172,ç´ç´,è‘£ç€šåµ˜,15872962839,-
S173,ç†™ğŸ‘¦ğŸ»æ‚¦ğŸ‘§ğŸ»,æ­¦é¦¨æ‚¦,15660010404,5
S174,real.life,çªçª,13568880112,-
S175,éœ²å­,ç³–ç³–,18727160721,25
S176,ğŸŒ¿,è…¾å®,13382903242,0
S177,å®å®,å®‡æ–°,15093600867,0
S178,ğŸ…ç•ªèŒ„å°å¤©ä½¿ğŸ…,å¾æ–‡é›…,18326022523,-
S179,ä½©,è‹¥ç³,13750244511,-
S180,å°æ¬¢å–œ,å˜Ÿå˜Ÿ,15963107787,0
S181,AçµèŠ,è¯šè¯š,13022346992,-
S182,ç”œä»¥å¾…äºº,ç¿å®,13935637070,0
S183,çˆ±åƒèœçš„è‚‰åŒ…å­,è‘£æ³“éœ„,15617694687,75
S184,å¹³å‡¡,æ±æ±,13879652020,150
S185,ğŸŒˆğŸŒˆsky ğŸŒ» YaliğŸ­ğŸ­,éœ–éœ–,13690556613,135
S186,Good-luckğŸ,å¤šå¤š,15103119992,60
S187,ğŸŒ¾,å½¤å½¤,18950427273,125
S188,ğŸ‘‘X.xiangğŸ’«,ç”œé¦¨,13988829011,5
S189,Yumi,Moony,-,-
S190,èŠ±jiangğŸŒˆæ™¨æ›¦ğŸ”†,Daniel,13732237327,185
S191,ï½.ï½,æçŸ¥å®‰,18213676445,0
S192,å¢å…‹,å¢æ¢“è½©,15019475685,155
S193,æå§,è®¸æ˜Œç¼˜,13977010113,75
S194,ğŸ’ è‹¥ç†,å°é’Ÿ,13765269807,-
S195,ğŸ””é’±åŒ…å“å®å½“,ç‘¾è±,13631747978,155
S196,å¿«å¤„å¿«èµ”å¢è‰³,å½­ç¥è±,18975843280,0
S197,æ¸…æ™¨(éŸ¦å®‡æ™¨15974246178),éŸ¦å®‡æ™¨,15974246178,0
S198,(ãƒ»ã€ãƒ»)è€˜,è€˜å„¿,18353506317,0
S199,é£é›¨å¤©æ¶¯ä¸­åŒ»é’ˆç¸,å»–å©§é›¯,18781079661,0
S200,çˆ±è°è°@,åˆ˜ä½©å…¶,13994374531,-
S201,æ—¶é—´çš„æœ‹å‹,æå°ä¼˜,13540629993,0
S202,å¿ƒå‘é˜³ï½æ— æ‰€ç•,å¢¨å¢¨,18092921706,75
S203,ç™½æ²³å²¸è¾¹ğŸŒ·,æœæœ,18337658526,120
S204,é™çœ‹æ—¥è½çƒŸéœ,ç‹å°é–,18834339933,150
S205,A Qå®å®è |æ¯å©´å„¿ç«¥å¥åº·è°ƒç†å¸ˆ,æ²ˆä¼Šæ¡,15768091198,0
S206,@æ—,ä½™æƒœ,18578275876,-
S207,ğŸŒ¾,å½¤å½¤,18950427273,-
S208,ğŸŒ¿(è…¾å®13382903242),ç‹è±«è…¾,13382903242,0
S209,æ°¸éœ,é™ˆæ’è‡»,15008960867,120
S210,éƒ‘æ™“å–µğŸ€(é»„ç† å®‰13435289624),é»„ç† å®‰,13435289624,140
S211,æ¥ æ¥ ,é—«ä¹‹ç©,15165001631,135
S212,å¯æ‚¦å„¿,å¤§åš,18222918751,-
S213,æœæœ,é™ˆæ˜±ç¿,13887890605,145
S214,summeræ£®,Qå¼¹ï¼ˆtanï¼‰,13711745853,0
S215,æ·¡å¦‚èŠ(é™ˆå–†13754063202),é™ˆå–†,13754063202,95
S216,ğŸ’°å°è´¢è¿·ğŸ§§,ç¡•ç¡•,-,-
S217,æ–‘æ–“(è´è´ 13968538380),è´è´,13968538380,-
S218,ä¸½ä¸½|ç¤¾å›¢&å¿«é€’,è±†è±†,13862564887,120
S219,æ¿€åˆ°ä½ ç”Ÿæ¬§æ¬§å¥³å£«,æ¢“è¾°,18302098414,-
S220,ç¹,æ¶µå®‡,13546206232,0
S221,æè‹—ğŸ’,å°å‘¨æœ«,15986434862,0
S222,æ²™å­,Peter,15907155257,140
S223,å¤©æ˜Ÿæ‰˜ç®¡Â·æ ¸å¿ƒå­¦èƒ½ğŸ‡¨ğŸ‡³å¾å°ç‡•(å¾é¹è…¾13599159188),å¾é¹è…¾,13599159188,75
S224,ç¨»ç”°(ä¸€è¯º 15070980472),ä¸€è¯º,15070980472,5
S225,å’æ­Œ,è‡´è¿œ,13908704312,180
S226,å®‰å‰å°”å‡€æ°´å™¨-é»„ï½ç18779579619,æ™¶æ™¶,18779579619,0
S227,Catrina,èµµç‘¾æ¡,13450890469,0
S228,ä»å¤´å¼€å§‹,æ±¤æµ©,18362547919,60
S229,å¤§æœç²’,å˜‰æ ‹,18764616139,160
S230,hf,å•ä½³ä¸€,15386096178,150
S231,æš–æš–çš„,ç§‰å‹¤,15837366824,120
S232,~,ç¿°å“¥å“¥,15978229228,-
S233,æœˆå§‘å¨˜,ç¯¼ç¯¼,13388909110,40
S234,LeticeğŸŒ¸,èŠ±ç”Ÿç±³,13636466645,-
S235,ğŸğŸ’‹ ğŸ,é™ˆç¾çª,15938263770,40
S236,å‘é˜³,èŠŠèŠŠ,15173919201,120
S237,è•¾...ğŸ’‹,å¼ è¿ªè€¶,15981788381,-
S238,î€ƒå°é›¨å˜‰,å°é›¨,13961863306,110
S239,æ¡ƒæä¸è¨€,å°ç³–,15911080445,0
S240,ä¹˜é¾™,åœ£åœ£,19872909828,-
S241,Ivy,é˜³é˜³,13922238770,120
S242,å†¬å¤©é‚£æŠŠç«,,18101348350,100
S243,å™å°é¦†13310971742,æ¥šä½³ç¦,13310971742,-
S244,Dan,ç›Šå®,18910892070,-
S245,å²æœˆå‡é¦™,è½©è½©,18559648163,0
S246,Cherry,æ¢“æ€¡,13928852315,-
S247,å¼ éœ,æ¨ä¹‰é‘«,13864645228,80
S248,CXJ,è½©è½©,13485185292,-
S249,æ¸…é£é£èˆ,ç‹å°å®‡,18209035600,130
S250,çˆºå€‘â˜…åƒ¦é€™è„¾æ°—,é‚±ä¿Šåš,13960575059,0
S251,ğŸ’°å°è´¢è¿·ğŸ§§,ç¡•ç¡•,13642137022,-
S252,æ©™å­,é»„æ¢“éœ–,13825963753,75
S253,ğŸŒˆä¹”å¦¹å„¿,æ¶µæ¶µ,19350561818,180
S254,Tonyæ°,ç†™æ°,19262070665,-
S255,ä¸é›¨,ä½Ÿç¾½éœï¼ˆéœéœï¼‰,18911562688,0
S256,å“ˆå–½è´æ¯”æ—©æ•™Rita æ¨è€å¸ˆğŸ’•,è¯­æ¡,15007652517,65
S257,å¾®é›¨è½»å°˜-äº‘å—ä¸“çº¿,æª€å°åŒ…,18203615027,0
S258,eiwa,æ³¡æ³¡,13181972908,170
S259,Yumi,MOONY,18819020184,150`;

        // ----------------------------------------------------------------------
        // 3. è¾…åŠ©å‡½æ•°
        // ----------------------------------------------------------------------
        const parseCSV = (csvText) => {
            const lines = csvText.trim().split('\n');
            const headers = lines[0].split(',').map(h => h.trim());
            
            // åŠ¨æ€æŸ¥æ‰¾åˆ—ç´¢å¼•ï¼Œæ”¯æŒå¸¦æ‹¬å·çš„å¤æ‚è¡¨å¤´
            const findIndex = (keywords) => headers.findIndex(h => keywords.every(k => h.includes(k)));
            
            const indices = {
                nick: findIndex(['ç”¨æˆ·æ˜µç§°']),
                phone: findIndex(['æ‰‹æœºå·']),
                w1_math: findIndex(['ç¬¬ä¸€å‘¨', 'æ•°å­¦']),
                w1_chi: findIndex(['ç¬¬ä¸€å‘¨', 'è¯­æ–‡']),
                w1_eng: findIndex(['ç¬¬ä¸€å‘¨', 'è‹±è¯­']),
                w2_math: findIndex(['ç¬¬äºŒå‘¨', 'æ•°å­¦']),
                w2_chi: findIndex(['ç¬¬äºŒå‘¨', 'è¯­æ–‡']),
                w2_eng: findIndex(['ç¬¬äºŒå‘¨', 'è‹±è¯­']),
                w3_math: findIndex(['ç¬¬ä¸‰å‘¨', 'æ•°å­¦']),
                w3_chi: findIndex(['ç¬¬ä¸‰å‘¨', 'è¯­æ–‡']),
                w3_eng: findIndex(['ç¬¬ä¸‰å‘¨', 'è‹±è¯­']),
                w4_math: findIndex(['ç¬¬å››å‘¨', 'æ•°å­¦']),
                w4_chi: findIndex(['ç¬¬å››å‘¨', 'è¯­æ–‡']),
                w4_eng: findIndex(['ç¬¬å››å‘¨', 'è‹±è¯­']),
            };

            // è§£ææ—¶è¿‡æ»¤ç©ºè¡Œ
            return lines.slice(1).filter(l => l.trim()).map(line => {
                const values = line.split(',');
                const getVal = (idx) => (idx !== -1 && values[idx]) ? values[idx].trim() : '0';

                return {
                    'å¾®ä¿¡æ˜µç§°': getVal(indices.nick),
                    'æ‰‹æœºå·ç ': getVal(indices.phone),
                    'ç¬¬ä¸€å‘¨æ•°å­¦': getVal(indices.w1_math),
                    'ç¬¬ä¸€å‘¨è¯­æ–‡': getVal(indices.w1_chi),
                    'ç¬¬ä¸€å‘¨è‹±è¯­': getVal(indices.w1_eng),
                    'ç¬¬äºŒå‘¨æ•°å­¦': getVal(indices.w2_math),
                    'ç¬¬äºŒå‘¨è¯­æ–‡': getVal(indices.w2_chi),
                    'ç¬¬äºŒå‘¨è‹±è¯­': getVal(indices.w2_eng),
                    'ç¬¬ä¸‰å‘¨æ•°å­¦': getVal(indices.w3_math),
                    'ç¬¬ä¸‰å‘¨è¯­æ–‡': getVal(indices.w3_chi),
                    'ç¬¬ä¸‰å‘¨è‹±è¯­': getVal(indices.w3_eng),
                    'ç¬¬å››å‘¨æ•°å­¦': getVal(indices.w4_math),
                    'ç¬¬å››å‘¨è¯­æ–‡': getVal(indices.w4_chi),
                    'ç¬¬å››å‘¨è‹±è¯­': getVal(indices.w4_eng),
                };
            });
        };

        const parseDuration = (val) => {
            const floatVal = parseFloat(val);
            return isNaN(floatVal) ? 0 : floatVal;
        };

        const formatDuration = (val) => {
            const minutes = parseDuration(val);
            return Math.round(minutes) + 'åˆ†é’Ÿ';
        };

        const isAttended = (val) => {
            return parseDuration(val) >= 30; // æ ‡å‡†ï¼š30åˆ†é’Ÿä»¥ä¸Š
        };

        const calculateScore = (data) => {
            const scores = data
                .map(d => parseFloat(d['å…¥å­¦æµ‹è¯•æƒ…å†µ']))
                .filter(s => !isNaN(s) && s > 0);
            if (scores.length === 0) return 0;
            return (scores.reduce((a, b) => a + b, 0) / scores.length).toFixed(1);
        };

        const calculateAttendance = (data, durationKey) => {
            const attendees = data.filter(d => isAttended(d[durationKey])).length;
            return ((attendees / data.length) * 100).toFixed(1);
        };

        // ----------------------------------------------------------------------
        // 4. ä¸»ç»„ä»¶
        // ----------------------------------------------------------------------
        const App = () => {
            const [data, setData] = useState([]);
            const [searchTerm, setSearchTerm] = useState('');
            const [sortConfig, setSortConfig] = useState({ key: null, direction: 'asc' });
            const [selectedStudent, setSelectedStudent] = useState(null);
            const [filterType, setFilterType] = useState('all');
            const [currentWeek, setCurrentWeek] = useState('W2');

            // åˆå§‹åŒ–ï¼šåˆå¹¶æ•°æ® & ç§»é™¤è‡ªåŠ¨å»é‡ï¼Œä¿ç•™å…¨éƒ¨è¡Œ
            useEffect(() => {
                // 1. è§£æåŸå§‹æ•°æ®
                const rawAttendanceList = parseCSV(ATTENDANCE_CSV);
                
                // 2. è§£ææ¡£æ¡ˆæ•°æ®å­—å…¸
                const parsedInfoList = STUDENT_INFO_CSV.trim().split('\n').slice(1).map(line => {
                    const parts = line.split(',');
                    return {
                        'å­¦å·': parts[0],
                        'å¾®ä¿¡æ˜µç§°': parts[1],
                        'å­¦å‘˜å§“å': parts[2],
                        'è”ç³»ç”µè¯': parts[3],
                        'å…¥å­¦æµ‹è¯•æƒ…å†µ': parts[4]
                    };
                });

                const infoByPhone = {};
                const infoByNick = {};
                parsedInfoList.forEach(info => {
                    if (info['è”ç³»ç”µè¯']) infoByPhone[info['è”ç³»ç”µè¯']] = info;
                    if (info['å¾®ä¿¡æ˜µç§°']) infoByNick[info['å¾®ä¿¡æ˜µç§°']] = info;
                });

                // 3. ç›´æ¥ä½¿ç”¨å…¨é‡æ•°æ®ï¼Œä¸å†è¿›è¡Œå»é‡åˆå¹¶
                const mergedData = rawAttendanceList.map(item => {
                    const phone = item['æ‰‹æœºå·ç '];
                    const nick = item['å¾®ä¿¡æ˜µç§°'];
                    let matchedInfo = null;
                    
                    if (phone && infoByPhone[phone]) {
                        matchedInfo = infoByPhone[phone];
                    } else if (nick && infoByNick[nick]) {
                        matchedInfo = infoByNick[nick];
                    }

                    return {
                        ...item,
                        'å­¦å‘˜å§“å': matchedInfo ? matchedInfo['å­¦å‘˜å§“å'] : nick, // åŒ¹é…ä¸åˆ°æ˜¾ç¤ºæ˜µç§°
                        'å…¥å­¦æµ‹è¯•æƒ…å†µ': matchedInfo ? matchedInfo['å…¥å­¦æµ‹è¯•æƒ…å†µ'] : '-',
                        'å­¦å·': matchedInfo ? matchedInfo['å­¦å·'] : '-'
                    };
                });

                setData(mergedData);
            }, []);

            const stats = useMemo(() => {
                if (data.length === 0) return null;
                const weekMap = { 'W1': 'ç¬¬ä¸€å‘¨', 'W2': 'ç¬¬äºŒå‘¨', 'W3': 'ç¬¬ä¸‰å‘¨', 'W4': 'ç¬¬å››å‘¨' };
                const prefix = weekMap[currentWeek];
                
                return {
                    totalStudents: data.length, // æ˜¾ç¤ºå…¨é‡äººæ•°
                    avgScore: calculateScore(data),
                    chineseAttendance: calculateAttendance(data, prefix + 'è¯­æ–‡'),
                    mathAttendance: calculateAttendance(data, prefix + 'æ•°å­¦'),
                    englishAttendance: calculateAttendance(data, prefix + 'è‹±è¯­'),
                    weekLabel: prefix
                };
            }, [data, currentWeek]);

            const processedData = useMemo(() => {
                let filtered = [...data];

                if (searchTerm) {
                    const lowerTerm = searchTerm.toLowerCase();
                    filtered = filtered.filter(item => 
                        (item['å¾®ä¿¡æ˜µç§°'] && item['å¾®ä¿¡æ˜µç§°'].toLowerCase().includes(lowerTerm)) ||
                        (item['å­¦å‘˜å§“å'] && item['å­¦å‘˜å§“å'].toLowerCase().includes(lowerTerm)) ||
                        (item['æ‰‹æœºå·ç '] && item['æ‰‹æœºå·ç '].includes(lowerTerm))
                    );
                }

                if (filterType === 'attended') {
                    filtered = filtered.filter(item => 
                        ['ç¬¬ä¸€å‘¨', 'ç¬¬äºŒå‘¨', 'ç¬¬ä¸‰å‘¨', 'ç¬¬å››å‘¨'].some(week => 
                            ['è¯­æ–‡', 'æ•°å­¦', 'è‹±è¯­'].some(subj => isAttended(item[week + subj]))
                        )
                    );
                }

                if (sortConfig.key) {
                    filtered.sort((a, b) => {
                        let aValue, bValue;
                        if (['å…¥å­¦æµ‹è¯•æƒ…å†µ'].includes(sortConfig.key)) {
                            const aNum = parseFloat(a[sortConfig.key]);
                            const bNum = parseFloat(b[sortConfig.key]);
                            aValue = isNaN(aNum) ? -1 : aNum;
                            bValue = isNaN(bNum) ? -1 : bNum;
                        } else if (sortConfig.key === 'å­¦å‘˜å§“å') {
                             aValue = a[sortConfig.key];
                             bValue = b[sortConfig.key];
                        } else {
                            aValue = a[sortConfig.key];
                            bValue = b[sortConfig.key];
                        }
                        if (aValue < bValue) return sortConfig.direction === 'asc' ? -1 : 1;
                        if (aValue > bValue) return sortConfig.direction === 'asc' ? 1 : -1;
                        return 0;
                    });
                }
                return filtered;
            }, [data, searchTerm, sortConfig, filterType]);

            const requestSort = (key) => {
                let direction = 'asc';
                if (sortConfig.key === key && sortConfig.direction === 'asc') direction = 'desc';
                setSortConfig({ key, direction });
            };

            const getSortIcon = (key) => {
                if (sortConfig.key !== key) return <div className="w-4 h-4" />;
                return sortConfig.direction === 'asc' ? <ChevronUp size={16} /> : <ChevronDown size={16} />;
            };

            const CourseCell = ({ subject, duration }) => {
                const completed = isAttended(duration);
                return (
                    <div className={`p-2 rounded-md border text-center text-xs ${completed ? 'bg-green-50 border-green-100' : 'bg-gray-50 border-gray-100'}`}>
                        <div className="font-semibold mb-1">{subject}</div>
                        <div className="text-gray-600 mb-1">{formatDuration(duration)}</div>
                        {completed ? <span className="text-green-600 font-bold">âœ“ å·²å®Œæˆ</span> : <span className="text-gray-400">æœªå®Œæˆ</span>}
                    </div>
                );
            };

            const EmptyWeekCell = ({ week }) => (
                <div className="p-2 rounded-md border border-dashed border-gray-200 bg-gray-50 text-center text-xs text-gray-400 flex flex-col justify-center items-center h-full min-h-[90px]">
                    <span className="font-bold mb-1">{week}</span>
                    <span>æš‚æ— æ•°æ®</span>
                </div>
            );

            return (
                <div className="min-h-screen pb-10">
                    <header className="bg-white border-b border-gray-200 sticky top-0 z-30 shadow-sm">
                        <div className="max-w-full mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between">
                            <div className="flex items-center gap-3">
                                <div className="bg-blue-600 p-2 rounded-lg text-white"><BarChart3 size={24} /></div>
                                <h1 className="text-xl font-bold text-gray-900 hidden sm:block">æ–—åŠåŒ æœŸæœ«å†²åˆº Â· å­¦æƒ…çœ‹æ¿</h1>
                                <h1 className="text-xl font-bold text-gray-900 sm:hidden">å­¦æƒ…çœ‹æ¿</h1>
                            </div>
                            <div className="text-sm text-gray-500">ä¸‰å¹´çº§ | {new Date().toLocaleDateString()}</div>
                        </div>
                    </header>

                    <main className="max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-8">
                        {stats && (
                            <>
                                <div className="flex justify-end mb-4 overflow-x-auto">
                                     <div className="inline-flex rounded-md shadow-sm" role="group">
                                        {['W1', 'W2', 'W3', 'W4'].map((week, idx) => (
                                            <button 
                                                key={week}
                                                type="button" 
                                                onClick={() => setCurrentWeek(week)}
                                                className={`px-4 py-2 text-sm font-medium border border-gray-200 tab-btn
                                                    ${idx === 0 ? 'rounded-l-lg' : ''} 
                                                    ${idx === 3 ? 'rounded-r-lg' : ''}
                                                    ${currentWeek === week ? 'bg-blue-600 text-white hover:bg-blue-700' : 'bg-white text-gray-900 hover:bg-gray-50'}
                                                `}
                                            >
                                                {week === 'W1' ? 'ç¬¬ä¸€å‘¨' : week === 'W2' ? 'ç¬¬äºŒå‘¨' : week === 'W3' ? 'ç¬¬ä¸‰å‘¨' : 'ç¬¬å››å‘¨'}
                                            </button>
                                        ))}
                                    </div>
                                </div>

                                <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4 mb-8">
                                    <div className="bg-white rounded-xl shadow-sm p-6 border border-gray-100 flex items-start justify-between">
                                        <div><p className="text-sm font-medium text-gray-500 mb-1">æ€»å­¦å‘˜äººæ•°</p><h3 className="text-3xl font-bold text-gray-900">{stats.totalStudents}</h3></div>
                                        <div className="p-3 bg-blue-50 rounded-lg text-blue-600"><User size={24} /></div>
                                    </div>
                                    <div className="bg-white rounded-xl shadow-sm p-6 border border-gray-100 flex items-start justify-between">
                                        <div><p className="text-sm font-medium text-gray-500 mb-1">æ‘¸åº•æµ‹å¹³å‡åˆ†</p><h3 className="text-3xl font-bold text-gray-900">{stats.avgScore}</h3></div>
                                        <div className="p-3 bg-purple-50 rounded-lg text-purple-600"><Calculator size={24} /></div>
                                    </div>
                                    <div className="bg-white rounded-xl shadow-sm p-6 border border-gray-100 flex items-start justify-between">
                                        <div><p className="text-sm font-medium text-gray-500 mb-1">{stats.weekLabel}è¯­æ–‡åˆ°è¯¾</p><h3 className="text-3xl font-bold text-gray-900">{stats.chineseAttendance}%</h3></div>
                                        <div className="p-3 bg-red-50 rounded-lg text-red-600"><BookOpen size={24} /></div>
                                    </div>
                                    <div className="bg-white rounded-xl shadow-sm p-6 border border-gray-100 flex items-start justify-between">
                                        <div><p className="text-sm font-medium text-gray-500 mb-1">{stats.weekLabel}æ•°å­¦åˆ°è¯¾</p><h3 className="text-3xl font-bold text-gray-900">{stats.mathAttendance}%</h3></div>
                                        <div className="p-3 bg-indigo-50 rounded-lg text-indigo-600"><Calculator size={24} /></div>
                                    </div>
                                    <div className="bg-white rounded-xl shadow-sm p-6 border border-gray-100 flex items-start justify-between">
                                        <div><p className="text-sm font-medium text-gray-500 mb-1">{stats.weekLabel}è‹±è¯­åˆ°è¯¾</p><h3 className="text-3xl font-bold text-gray-900">{stats.englishAttendance}%</h3></div>
                                        <div className="p-3 bg-yellow-50 rounded-lg text-yellow-600"><Languages size={24} /></div>
                                    </div>
                                </div>
                            </>
                        )}

                        <div className="flex flex-col sm:flex-row gap-4 mb-6 justify-between items-center">
                            <div className="relative w-full sm:w-96">
                                <div className="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"><Search className="h-5 w-5 text-gray-400" /></div>
                                <input type="text" className="block w-full pl-10 pr-3 py-2.5 border border-gray-300 rounded-lg leading-5 bg-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 sm:text-sm shadow-sm" placeholder="æœç´¢å§“åã€æ˜µç§°æˆ–æ‰‹æœºå·..." value={searchTerm} onChange={(e) => setSearchTerm(e.target.value)} />
                            </div>
                            <div className="flex items-center gap-2 w-full sm:w-auto">
                                <Filter size={20} className="text-gray-400" />
                                <select value={filterType} onChange={(e) => setFilterType(e.target.value)} className="block w-full sm:w-auto pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-lg shadow-sm">
                                    <option value="all">æ˜¾ç¤ºå…¨éƒ¨å­¦å‘˜</option>
                                    <option value="attended">ä»…æ˜¾ç¤ºå·²åˆ°è¯¾å­¦å‘˜</option>
                                </select>
                            </div>
                        </div>

                        <div className="bg-white shadow-sm rounded-xl overflow-hidden border border-gray-200">
                            <div className="overflow-x-auto">
                                <table className="min-w-full divide-y divide-gray-200">
                                    <thead className="bg-gray-50">
                                        <tr>
                                            <th scope="col" className="px-6 py-4 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100" onClick={() => requestSort('å­¦å‘˜å§“å')}>
                                                <div className="flex items-center gap-1">å­¦å‘˜å§“å {getSortIcon('å­¦å‘˜å§“å')}</div>
                                            </th>
                                            <th scope="col" className="px-6 py-4 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">å¾®ä¿¡æ˜µç§° / æ‰‹æœº</th>
                                            <th scope="col" className="px-6 py-4 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100" onClick={() => requestSort('å…¥å­¦æµ‹è¯•æƒ…å†µ')}>
                                                <div className="flex items-center gap-1">å…¥å­¦æˆç»© {getSortIcon('å…¥å­¦æµ‹è¯•æƒ…å†µ')}</div>
                                            </th>
                                            <th scope="col" className={`px-6 py-4 text-center text-xs font-semibold uppercase tracking-wider border-l border-r ${currentWeek === 'W1' ? 'bg-blue-50 border-blue-100 text-blue-700' : 'text-gray-400 border-gray-200'}`}>ç¬¬ä¸€å‘¨</th>
                                            <th scope="col" className={`px-6 py-4 text-center text-xs font-semibold uppercase tracking-wider border-r ${currentWeek === 'W2' ? 'bg-blue-50 border-blue-100 text-blue-700' : 'text-gray-400 border-gray-200'}`}>ç¬¬äºŒå‘¨</th>
                                            <th scope="col" className={`px-6 py-4 text-center text-xs font-semibold uppercase tracking-wider border-r ${currentWeek === 'W3' ? 'bg-blue-50 border-blue-100 text-blue-700' : 'text-gray-400 border-gray-200'}`}>ç¬¬ä¸‰å‘¨</th>
                                            <th scope="col" className={`px-6 py-4 text-center text-xs font-semibold uppercase tracking-wider ${currentWeek === 'W4' ? 'bg-blue-50 border-blue-100 text-blue-700' : 'text-gray-400'}`}>ç¬¬å››å‘¨</th>
                                            <th scope="col" className="px-6 py-4 text-center text-xs font-semibold text-gray-500 uppercase tracking-wider">æ“ä½œ</th>
                                        </tr>
                                    </thead>
                                    <tbody className="bg-white divide-y divide-gray-200">
                                        {processedData.length > 0 ? (
                                            processedData.map((student, index) => (
                                                <tr key={index} className="hover:bg-blue-50 transition-colors cursor-pointer" onClick={() => setSelectedStudent(student)}>
                                                    <td className="px-6 py-4 whitespace-nowrap text-sm font-bold text-gray-900">
                                                        {student['å­¦å‘˜å§“å']}
                                                    </td>
                                                    <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                        <div className="font-medium text-gray-900">{student['å¾®ä¿¡æ˜µç§°']}</div>
                                                        <div className="text-xs font-mono mt-0.5">{student['æ‰‹æœºå·ç ']}</div>
                                                    </td>
                                                    
                                                    <td className="px-6 py-4 whitespace-nowrap">
                                                        <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${
                                                            parseFloat(student['å…¥å­¦æµ‹è¯•æƒ…å†µ']) >= 160 ? 'bg-green-100 text-green-800' :
                                                            parseFloat(student['å…¥å­¦æµ‹è¯•æƒ…å†µ']) >= 120 ? 'bg-blue-100 text-blue-800' :
                                                            parseFloat(student['å…¥å­¦æµ‹è¯•æƒ…å†µ']) > 0 ? 'bg-yellow-100 text-yellow-800' :
                                                            'bg-gray-100 text-gray-800'
                                                        }`}>{student['å…¥å­¦æµ‹è¯•æƒ…å†µ']}</span>
                                                    </td>
                                                    
                                                    {['ç¬¬ä¸€å‘¨', 'ç¬¬äºŒå‘¨', 'ç¬¬ä¸‰å‘¨', 'ç¬¬å››å‘¨'].map((week, wIdx) => {
                                                        const isCurrent = currentWeek === `W${wIdx + 1}`;
                                                        return (
                                                            <td key={week} className={`px-4 py-4 border-r border-gray-200 ${isCurrent ? 'bg-blue-50/30' : ''}`}>
                                                                <div className="grid grid-cols-3 gap-2 min-w-[240px]">
                                                                    <CourseCell subject="è¯­æ–‡" duration={student[week + 'è¯­æ–‡']} />
                                                                    <CourseCell subject="æ•°å­¦" duration={student[week + 'æ•°å­¦']} />
                                                                    <CourseCell subject="è‹±è¯­" duration={student[week + 'è‹±è¯­']} />
                                                                </div>
                                                            </td>
                                                        );
                                                    })}

                                                    <td className="px-6 py-4 whitespace-nowrap text-center text-sm font-medium">
                                                        <button className="text-blue-600 hover:text-blue-900" onClick={(e) => { e.stopPropagation(); setSelectedStudent(student); }}>è¯¦æƒ…</button>
                                                    </td>
                                                </tr>
                                            ))
                                        ) : (
                                            <tr><td colSpan="8" className="px-6 py-10 text-center text-sm text-gray-500">æœªæ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„å­¦å‘˜æ•°æ®</td></tr>
                                        )}
                                    </tbody>
                                </table>
                            </div>
                            <div className="bg-gray-50 px-6 py-3 border-t border-gray-200 flex items-center justify-between"><span className="text-sm text-gray-500">å…±æ˜¾ç¤º {processedData.length} æ¡è®°å½•</span></div>
                        </div>
                    </main>

                    {selectedStudent && (
                        <div className="fixed inset-0 z-50 overflow-y-auto" aria-labelledby="modal-title" role="dialog" aria-modal="true">
                            <div className="flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
                                <div className="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity" onClick={() => setSelectedStudent(null)}></div>
                                <div className="inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full">
                                    <div className="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
                                        <div className="flex justify-between items-center mb-4">
                                            <h3 className="text-lg leading-6 font-medium text-gray-900">å­¦å‘˜è¯¦æƒ…æ¡£æ¡ˆ</h3>
                                            <button onClick={() => setSelectedStudent(null)} className="text-gray-400 hover:text-gray-500"><X size={20} /></button>
                                        </div>
                                        <div className="bg-blue-50 p-4 rounded-lg mb-6">
                                            <div className="grid grid-cols-2 gap-4">
                                                <div><p className="text-xs text-blue-500 uppercase tracking-wider font-semibold">å§“å</p><p className="text-lg font-bold text-gray-900">{selectedStudent['å­¦å‘˜å§“å']}</p></div>
                                                <div><p className="text-xs text-blue-500 uppercase tracking-wider font-semibold">å¾®ä¿¡æ˜µç§°</p><p className="text-base text-gray-700">{selectedStudent['å¾®ä¿¡æ˜µç§°']}</p></div>
                                                <div className="col-span-2"><p className="text-xs text-blue-500 uppercase tracking-wider font-semibold">æ‰‹æœºå·ç </p><p className="text-base font-mono text-gray-700">{selectedStudent['æ‰‹æœºå·ç ']}</p></div>
                                            </div>
                                        </div>
                                        <div className="max-h-[60vh] overflow-y-auto pr-2">
                                            {['ç¬¬ä¸€å‘¨', 'ç¬¬äºŒå‘¨', 'ç¬¬ä¸‰å‘¨', 'ç¬¬å››å‘¨'].map((week, idx) => (
                                                <div key={week} className="mb-6">
                                                    <h4 className="font-medium text-gray-900 mb-2 flex items-center gap-2">
                                                        <span className={`w-1.5 h-4 rounded-full ${['bg-blue-500', 'bg-green-500', 'bg-purple-500', 'bg-orange-500'][idx]}`}></span>
                                                        {week}å­¦ä¹ æƒ…å†µ
                                                    </h4>
                                                    <div className="space-y-2">
                                                        <div className="flex items-center justify-between p-3 bg-white border border-gray-100 rounded-lg shadow-sm">
                                                            <div className="flex items-center gap-3"><BookOpen className="text-blue-500" /><span className="text-sm">è¯­æ–‡</span></div>
                                                            <div className="text-right"><span className="text-gray-900 font-medium">{formatDuration(selectedStudent[week + 'è¯­æ–‡'])}</span>{isAttended(selectedStudent[week + 'è¯­æ–‡']) && <span className="ml-2 text-xs text-green-600 font-bold">âœ“</span>}</div>
                                                        </div>
                                                        <div className="flex items-center justify-between p-3 bg-white border border-gray-100 rounded-lg shadow-sm">
                                                            <div className="flex items-center gap-3"><Calculator className="text-blue-500" /><span className="text-sm">æ•°å­¦</span></div>
                                                            <div className="text-right"><span className="text-gray-900 font-medium">{formatDuration(selectedStudent[week + 'æ•°å­¦'])}</span>{isAttended(selectedStudent[week + 'æ•°å­¦']) && <span className="ml-2 text-xs text-green-600 font-bold">âœ“</span>}</div>
                                                        </div>
                                                        <div className="flex items-center justify-between p-3 bg-white border border-gray-100 rounded-lg shadow-sm">
                                                            <div className="flex items-center gap-3"><Languages className="text-blue-500" /><span className="text-sm">è‹±è¯­</span></div>
                                                            <div className="text-right"><span className="text-gray-900 font-medium">{formatDuration(selectedStudent[week + 'è‹±è¯­'])}</span>{isAttended(selectedStudent[week + 'è‹±è¯­']) && <span className="ml-2 text-xs text-green-600 font-bold">âœ“</span>}</div>
                                                        </div>
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                    <div className="bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse">
                                        <button type="button" className="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none sm:ml-3 sm:w-auto sm:text-sm" onClick={() => setSelectedStudent(null)}>å…³é—­</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>